# Trading AI Tips - Trading Configuration
# This file contains trading-specific settings and parameters

# =============================================================================
# SAFETY & VALIDATION CONFIGURATION
# =============================================================================
safety:
  # Incomplete candle handling
  allow_incomplete_candles: false  # Set to true to allow trading on still-forming candles
  
  # Data validation
  min_data_points_for_indicators: 50  # Minimum bars needed for reliable indicators
  safety_margin: 10  # Extra bars beyond minimum for safety
  
  # Candle freshness validation (in minutes)
  max_candle_staleness:
    "1m": 2    # 1-minute candles stale after 2 minutes
    "5m": 8    # 5-minute candles stale after 8 minutes  
    "15m": 20  # 15-minute candles stale after 20 minutes
    "1h": 70   # 1-hour candles stale after 70 minutes
  
  # Threshold validation
  validate_thresholds: true
  normalize_weights: true  # Automatically normalize weights to sum to 1.0
  
  # Sentiment analysis
  deterministic_sampling: true  # Use deterministic sampling for reproducible results
  sentiment_timeout_seconds: 30  # Timeout for sentiment analysis
  
  # External data timeouts
  market_data_timeout_seconds: 15
  rss_timeout_seconds: 10
  reddit_timeout_seconds: 15
  
  # Circuit breaker settings
  circuit_breaker:
    enabled: true
    failure_threshold: 3  # Fail after 3 consecutive failures
    cooldown_minutes: 5   # Cooldown period in minutes

# =============================================================================
# TRADING UNIVERSE CONFIGURATION
# =============================================================================
universe:
  # Supported trading symbols organized by asset class
  symbols:
    crypto:
      # Cryptocurrency trading pairs (CCXT format)
      - "BTC/USDT"    # Bitcoin vs USDT
      - "ETH/USDT"    # Ethereum vs USDT
      - "BNB/USDT"    # Binance Coin vs USDT
      - "ADA/USDT"    # Cardano vs USDT
      - "SOL/USDT"    # Solana vs USDT
    stocks:
      # Stock symbols (Alpaca format) - Currently disabled
      # Uncomment and add stock symbols when Alpaca API keys are configured
      #- "AAPL"        # Apple Inc.
      #- "GOOGL"       # Alphabet Inc. (Google)
      #- "MSFT"        # Microsoft Corporation
      #- "TSLA"        # Tesla Inc.
      #- "AMZN"        # Amazon.com Inc.
      #- "NVDA"        # NVIDIA Corporation
  
  # Default timeframe for technical analysis and signal generation
  # Optimized for short-term crypto trading - ultra-fast for scalping
  default_timeframe: "1h"
  
  # Available timeframes for analysis (optimized for short-term crypto trading)
  timeframes:
    - "1m"     # Ultra short-term scalping (0-5 minute trades) - DEFAULT
    - "5m"     # Short-term scalping (5-30 minute trades)
    - "15m"    # Quick swing trades (30 minutes - 2 hours)
    - "1h"     # Short swing trades (2-8 hours)
    
# =============================================================================
# SIGNAL GENERATION CONFIGURATION
# =============================================================================
signals:
  # Default thresholds for signal generation (fused score ranges)
  # Optimized for ultra-short-term crypto scalping - very sensitive to small moves
  thresholds:
    # Minimum fused score to generate BUY signal (0.0 to 1.0)
    # Ultra-sensitive for 1-minute scalping - captures small moves quickly
    buy_threshold: 0.08
    
    # Maximum fused score to generate SELL signal (-1.0 to 0.0)
    # Ultra-sensitive for 1-minute scalping - captures small moves quickly
    sell_threshold: -0.08
    
  # Weight configuration for signal fusion (must sum to 1.0)
  # Optimized for ultra-short-term crypto scalping - technical analysis is most reliable
  weights:
    # Weight of technical analysis in final signal (0.0 to 1.0)
    # Maximized for ultra-short-term scalping - technicals are most reliable for 1-minute trades
    technical_weight: 0.75
    
    # Weight of sentiment analysis in final signal (0.0 to 1.0)
    # Reduced for ultra-short-term scalping - sentiment is less relevant for 1-minute trades
    sentiment_weight: 0.25
    
  
  # Sentiment enhancement by asset type
  sentiment_enhancement:
    # Crypto sentiment amplification factor (1.2 = 20% amplification)
    crypto_amplification: 1.2
    
    # Stock sentiment amplification factor (1.0 = no amplification)
    stock_amplification: 1.0
  
  # Risk management by asset type
  risk_management_by_asset:
    crypto:
      # Base stop loss multiplier for crypto (more volatile)
      base_stop_multiplier: 2.0
      # Base take profit multiplier for crypto
      base_tp_multiplier: 2.5
      # High volatility threshold for crypto (%)
      volatility_threshold_high: 3.0
      # Low volatility threshold for crypto (%)
      volatility_threshold_low: 1.0
    
    stock:
      # Base stop loss multiplier for stocks (lower volatility)
      base_stop_multiplier: 1.5
      # Base take profit multiplier for stocks
      base_tp_multiplier: 2.0
      # High volatility threshold for stocks (%)
      volatility_threshold_high: 2.0
      # Low volatility threshold for stocks (%)
      volatility_threshold_low: 0.5
  
  # Market regime adjustments
  regime_adjustments:
    # Bull market adjustments
    bull_market:
      # Stop multiplier adjustment for BUY signals (0.8 = 20% tighter)
      buy_stop_adjustment: 0.8
      # Stop multiplier adjustment for SELL signals (1.3 = 30% wider)
      sell_stop_adjustment: 1.3
      # Take profit multiplier adjustment for BUY signals (1.2 = 20% higher)
      buy_tp_adjustment: 1.2
      # Take profit multiplier adjustment for SELL signals (0.8 = 20% lower)
      sell_tp_adjustment: 0.8
    
    # Bear market adjustments
    bear_market:
      # Stop multiplier adjustment for BUY signals (1.3 = 30% wider)
      buy_stop_adjustment: 1.3
      # Stop multiplier adjustment for SELL signals (0.8 = 20% tighter)
      sell_stop_adjustment: 0.8
      # Take profit multiplier adjustment for BUY signals (0.8 = 20% lower)
      buy_tp_adjustment: 0.8
      # Take profit multiplier adjustment for SELL signals (1.2 = 20% higher)
      sell_tp_adjustment: 1.2
  
  # Volatility adjustments
  volatility_adjustments:
    # High volatility multiplier (1.5 = 50% increase)
    high_volatility_multiplier: 1.5
    # Low volatility multiplier (0.8 = 20% decrease)
    low_volatility_multiplier: 0.8
    # Take profit adjustment for high volatility (1.2 = 20% increase)
    high_volatility_tp_adjustment: 1.2
  
  # Multi-timeframe analysis configuration
  multi_timeframe:
    # Enable multi-timeframe analysis by default
    enabled: true
    
    # Timeframes to analyze (optimized for ultra-short-term crypto scalping)
    timeframes:
      - "1m"     # Ultra short-term (50% weight) - for precise scalping entries
      - "5m"     # Short-term (30% weight) - for trend confirmation
      - "15m"    # Quick swing (20% weight) - for overall direction
    
    # Weights for each timeframe (must sum to 1.0)
    # Optimized for ultra-short-term crypto scalping - maximum weight on 1-minute
    weights:
      "1m": 0.5    # Ultra short-term weight (maximized for scalping)
      "5m": 0.3    # Short-term weight (reduced)
      "15m": 0.2   # Quick swing weight (reduced)
    
    # Number of data points to fetch for each timeframe
    data_points: 50
    
  # Technical indicator parameters (moved to specific sections below)
    
  # Risk management parameters
  risk_management:
    # Stop loss as percentage of entry price (0.01 = 1%) - ultra-tight for scalping
    stop_loss_percentage: 0.01
    
    # Take profit as percentage of entry price (0.02 = 2%) - quick profits for scalping
    take_profit_percentage: 0.02
    
    # Maximum position size as percentage of portfolio (0.15 = 15%) - slightly higher for scalping
    max_position_size: 0.15
    
    # Maximum number of signals per day per user - increased for scalping
    max_daily_signals: 50
    
    # ATR-based risk management multipliers - optimized for ultra-short-term crypto scalping
    # ATR stop loss multiplier (2.0 = 2.0x ATR for proper risk management)
    atr_stop_multiplier: 2.0
    
    # ATR take profit multiplier (2.5 = 2.5x ATR for good risk/reward ratio)
    atr_take_profit_multiplier: 2.5
    
# =============================================================================
# TECHNICAL ANALYSIS CONFIGURATION
# =============================================================================
technical_analysis:
  # Data fetching configuration for OHLCV data
  data_fetching:
    # Default number of historical data points to fetch
    default_limit: 200
    
    # Maximum number of data points allowed
    max_limit: 1000
    
    # Minimum number of data points required
    min_limit: 50
    
  # RSI (Relative Strength Index) Configuration
  # Enhanced for ultra-short-term crypto scalping with multiple variants
  rsi:
    # Period for RSI calculation - optimized for ultra-short-term crypto scalping
    # 5 recommended for 1-minute scalping - ultra-fast signals
    period: 5   
    
    # RSI calculation method
    # "wilder" = Wilder's RMA (original, more responsive)
    # "cutler" = Simple rolling means (steadier for short periods)
    method: "wilder"
    
    # Signal line smoothing (EMA of RSI to reduce whipsaws) - reduced for faster response
    signal_period: 3
    
    # Stochastic RSI settings - optimized for ultra-short-term scalping
    stoch_rsi:
      k_period: 8   # Period for %K calculation - reduced for faster response
      d_period: 2   # Period for %D smoothing - reduced for faster response
    
    # Dynamic thresholds based on market regime - optimized for ultra-short-term scalping
    thresholds:
      # Standard thresholds (for ranging markets) - tighter for scalping
      overbought: 65
      oversold: 35
      
      # Tight thresholds (for trending markets) - very tight for scalping
      overbought_tight: 50
      oversold_tight: 50
      
      # Extreme thresholds (for mean reversion) - tighter for scalping
      overbought_extreme: 75
      oversold_extreme: 25
    
    # Cross signal thresholds (for RSI signal line crosses) - optimized for scalping
    cross_thresholds:
      buy_cross: 40   # Buy when RSI crosses above signal below this level - more sensitive
      sell_cross: 60  # Sell when RSI crosses below signal above this level - more sensitive
    
  # MACD stands for Moving Average Convergence Divergence - it's one of the most popular technical indicators in trading.
  macd:
    # Fast EMA period - ultra-fast for 1-minute crypto scalping
    # Ultra-responsive to crypto volatility
    fast_period: 3
    
    # Slow EMA period - ultra-fast for 1-minute crypto scalping
    # Ultra-responsive to crypto volatility
    slow_period: 7
    
    # Signal line EMA period - ultra-fast for 1-minute crypto scalping
    # Ultra-responsive for quick signal generation
    signal_period: 2
    
  # ATR stands for Average True Range - it's a technical indicator that measures market volatility.

  atr:
    # Period for ATR calculation - ultra-fast for 1-minute crypto scalping
    # Ultra-responsive to crypto volatility changes
    period: 5
    
    # Note: ATR multipliers are configured in risk_management section
    # - atr_stop_multiplier: 1.2 (for tighter stop loss)
    # - atr_take_profit_multiplier: 2.0 (for better risk/reward ratio)
    
  # Moving Averages Configuration
  moving_averages:
    # Simple Moving Average periods to calculate - optimized for 1-minute scalping
    sma_periods: [10, 20, 50]
    
    # Exponential Moving Average periods to calculate
    # Optimized for 1-minute crypto scalping: 5 (ultra-fast), 8 (fast), 13 (trend filter)
    ema_periods: [5, 8, 13]
    
# =============================================================================
# SENTIMENT ANALYSIS CONFIGURATION
# =============================================================================
sentiment_analysis:
  # AI Model configuration for sentiment analysis
  model:
    # Hugging Face model name for financial sentiment analysis
    name: "ProsusAI/finbert"
    
    # Maximum text length for model input (tokens)
    max_length: 512
    
    # Batch size for model processing
    batch_size: 32
    
  # RSS feeds configuration
  rss_enabled: true
  
  # RSS feed URLs for comprehensive crypto and stock news
  rss_feeds:
    # Stock market news
    - "https://news.google.com/rss/search?q=stock+market&hl=en-US&gl=US&ceid=US:en"
    
    # Comprehensive crypto news sources
    - "https://cointelegraph.com/rss"                    # Main crypto news
    - "https://cointelegraph.com/rss/tag/altcoin"        # Altcoin specific news
    - "https://cointelegraph.com/rss/tag/ethereum"       # Ethereum specific news
    - "https://cointelegraph.com/rss/tag/defi"           # DeFi specific news
    - "https://www.coindesk.com/arc/outboundfeeds/rss/?outputType=xml"  # CoinDesk comprehensive
    - "https://cryptoslate.com/feed/"                    # CryptoSlate wide coverage
    - "https://decrypt.co/feed"                          # Decrypt DeFi & crypto
    - "https://cryptobriefing.com/feed/"                 # Crypto Briefing analysis
    - "https://www.newsbtc.com/feed/"                    # NewsBTC technical analysis
    - "https://www.theblock.co/rss.xml"                  # The Block institutional
  
  # Maximum headlines to fetch per RSS feed
  # Optimized for comprehensive crypto coverage (20-25 recommended)
  # Current: 11 feeds Ã— 20 headlines = ~220 max headlines for better sentiment analysis
  rss_max_headlines_per_feed: 20
  
  # Reddit integration configuration
  reddit_enabled: true
  
  # Subreddits to monitor for comprehensive crypto and stock sentiment
  # NOTE: Reduced for monitoring to prevent rate limits (429 errors)
  reddit_subreddits:
    # Major crypto communities (high activity, diverse opinions) - Core 6 for monitoring
    - "CryptoCurrency"    # General cryptocurrency discussion (6M+ members)
    - "Bitcoin"           # Bitcoin-specific discussion (4M+ members)
    - "ethereum"          # Ethereum-specific discussion (1M+ members)
    - "cryptomarkets"     # Crypto market analysis and trading
    - "cryptotrading"     # Active crypto trading community
    - "defi"              # Decentralized finance discussions
    
    # Stock market communities - Core 4 for monitoring
    - "investing"         # General investing discussion (2M+ members)
    - "stocks"            # Stock market discussion (1M+ members)
    - "SecurityAnalysis"  # Fundamental stock analysis
    - "ValueInvesting"    # Value investing strategies
    
    # Technology and fintech - Core 2 for monitoring
    - "technology"        # Tech news and discussions
    - "fintech"           # Financial technology
  
  # Maximum posts to fetch per subreddit
  # Reduced for monitoring to prevent rate limits (429 errors)
  reddit_max_posts_per_subreddit: 8
  
  # Sample size for sentiment analysis (random selection from all collected texts)
  # Increased to handle more diverse Reddit content
  reddit_sample_size: 50
  
  # Time filtering for ultra-short-term trading sentiment
  # Only fetch content from last N hours for more relevant sentiment
  # Options: 1 (very recent), 3 (short-term), 6 (medium-term), 12 (longer-term)
  hours_back: 1
      
  # Sentiment scoring thresholds
  scoring:
    # Minimum score to classify as positive sentiment
    positive_threshold: 0.1
    
    # Maximum score to classify as negative sentiment
    negative_threshold: -0.1
    
    # Range for neutral sentiment classification
    neutral_range: [-0.1, 0.1]
    
# =============================================================================
# EXCHANGE CONFIGURATION
# =============================================================================
exchanges:
  # CCXT Configuration (for cryptocurrency data)
  ccxt:
    # Default exchange for crypto data (binance, coinbase, etc.)
    default_exchange: "binance"
    
    # Enable rate limiting to avoid API limits
    rate_limit: true
    
    # Request timeout in milliseconds
    timeout: 30000
    
    # Number of retry attempts for failed requests
    retries: 3
    
  # Alpaca Configuration (for stock/ETF data)
  alpaca:
    # Base URL for Alpaca API (paper trading)
    base_url: "https://paper-api.alpaca.markets"
    
    # Data URL for market data API
    data_url: "https://data.alpaca.markets"
    
    # Request timeout in seconds
    timeout: 30
    
    # Number of retry attempts for failed requests
    retries: 3
    
# =============================================================================
# POSITION TRACKING CONFIGURATION
# =============================================================================
positions:
  # Position tracking settings
  tracking:
    # Enable/disable position tracking functionality
    enabled: true
    
    # Interval between position updates (minutes)
    update_interval_minutes: 5
    
    # Maximum number of positions per user
    max_positions_per_user: 50
    
  # Position lifecycle management
  lifecycle:
    # Automatically close positions when opposite signal is generated
    auto_close_on_signal: false
    
    # Maximum number of days to hold a position
    max_holding_days: 30
    
    # Minimum number of minutes to hold a position (prevents rapid trading) - reduced for scalping
    min_holding_minutes: 5
    
# =============================================================================
# BACKTESTING CONFIGURATION
# =============================================================================
backtesting:
  # Default backtest parameters
  default:
    # Start date for backtesting (YYYY-MM-DD format)
    start_date: "2024-01-01"
    
    # End date for backtesting (YYYY-MM-DD format)
    end_date: "2024-12-31"
    
    # Initial capital for backtesting (USD)
    initial_capital: 10000
    
    # Commission rate per trade (0.001 = 0.1%)
    commission: 0.001
    
  # Performance metrics to calculate during backtesting
  metrics:
    - "sharpe_ratio"      # Risk-adjusted return metric
    - "max_drawdown"      # Maximum peak-to-trough decline
    - "win_rate"          # Percentage of profitable trades
    - "total_return"      # Total return over backtest period
    - "volatility"        # Standard deviation of returns

# =============================================================================
# PHASE 4 (OPTIONAL) - DERIVATIVES & MICROSTRUCTURE CONFIGURATION
# =============================================================================
phase4:
  enabled: true  # Opt-in. When true, Phase 4 signals will blend into technical score

  # Weights for blending into the technical score (sum <= 0.4 recommended)
  weights:
    derivatives_weight: 0.15   # Contribution of derivatives score to technical score
    microstructure_weight: 0.10 # Contribution of microstructure score to technical score

  # Derivatives data integration (funding, open interest, basis)
  derivatives:
    enabled: true
    funding_rate_extreme: 0.02        # Absolute funding rate considered extreme (2%)
    open_interest_lookback_hours: 24  # Lookback window for OI change/divergence
    basis_lookback_hours: 24          # Lookback window for perp basis percentile

  # Microstructure data (order book & order flow)
  microstructure:
    enabled: true
    order_book_levels: 10             # Top N levels to compute imbalance
    imbalance_threshold: 0.60         # |bid - ask| / (bid + ask) to consider biased
    spread_widen_threshold_bps: 5     # Spread widening threshold (basis points)

# Monitoring configuration
monitoring:
  signal_check_interval_minutes: 1    # Check signals every 1 minute for short-term trading
  health_check_interval_seconds: 30   # Health check every 30 seconds
  max_concurrent_monitors: 10         # Maximum concurrent monitoring tasks
  history_retention_days: 30          # Keep monitoring history for 30 days
